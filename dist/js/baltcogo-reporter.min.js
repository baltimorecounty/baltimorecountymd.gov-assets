!function(){"use strict";angular.module("baltcogoApp",["ngMap"])}(),function(e){"use strict";function t(e){function t(e){return!!a($.grep(e,n))&&e[0].formatted_address}function a(e){var t="";return e&&e.length&&(t=e[0].formatted_address),t.indexOf(s)!==-1}function n(e,t){return o(e,t,"administrative_area_level_2")}function o(e,t,a){var n;return e.types&&(n=$.grep(e.types,function(e,t){return e===a})),!!n.length&&n}function r(e){return e.replace(", USA","")}var i,l="AIzaSyAqazsw3wPSSxOFVmij32C_LIhBSuyUNi8",s="Baltimore County";return{createMarker:function(e,t,a){i&&i.setMap(null),i=new google.maps.Marker({position:{lat:t,lng:a},map:e,draggable:!1,animation:google.maps.Animation.DROP})},reverseGeocode:function(a,n,o){var i=angular.element("#address");e.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+a+","+n+"&key="+l).then(function(e){var a=t(e.data.results);a?(i.parent().removeClass("error"),o(r(a))):(i.parent().addClass("error"),o(""))})},addressLookup:function(t,a){e.get("https://maps.googleapis.com/maps/api/geocode/json?address="+t+"&key="+l).then(function(e){if(e.data.results.length){var t=e.data.results[0].geometry.location.lat,n=e.data.results[0].geometry.location.lng;a(e.data.results[0].formatted_address,t,n)}else a("")},function(e){console.log("error!",e)})}}}e.factory("mapService",["$http",t])}(angular.module("baltcogoApp")),function(e){"use strict";function t(e,t,a,n){function o(){var e=angular.element("#citysourced-reporter-form .panel:visible [required]"),a=e.length,n=e.filter(".ng-valid").length;return angular.forEach(t.citySourcedReporterForm.$$controls,function(e,t,a){e.$$element.closest(".panel").is(":visible")&&e.$pristine&&e.$setDirty()}),a===n}function r(e){d.categoryData=e.data}function i(e){d.animalBreedData=e.data}function l(e){d.animalColorData=e.data}function s(e){d.animalTypeData=e.data}function u(e){d.petTypeData=e.data}function c(e){console.log(e)}var d=this;e.get("categories.json").then(r,c),e.get("animal-breeds.json").then(i,c),e.get("animal-colors.json").then(l,c),e.get("animal-types.json").then(s,c),e.get("pet-types.json").then(u,c),a.getMap().then(function(e){var t=e.getCenter();google.maps.event.trigger(e,"resize"),e.setCenter(t),d.map=e}),d.isAnimal=!1,d.page=1,d.mapClicked=function(e){d.latitude=e.latLng.lat(),d.longitude=e.latLng.lng(),n.createMarker(d.map,d.latitude,d.longitude),n.reverseGeocode(d.latitude,d.longitude,function(e){d.address=e})},d.autocompletePlaceChanged=function(){var e=this.getPlace();d.latitude=e.geometry.location.lat(),d.longitude=e.geometry.location.lng(),n.createMarker(d.map,d.latitude,d.longitude),d.map.panTo({lat:d.latitude,lng:d.longitude}),n.reverseGeocode(d.latitude,d.longitude,function(e){d.address=e})},d.addressLookup=function(){n.addressLookup(d.address,function(e,t,a){d.address=e,n.createMarker(d.map,t,a),d.map.panTo({lat:t,lng:a})})},d.trackBreed=function(){angular.element.each(d.animalBreedData,function(e,t){if(t.id===d.petType.id)return d.breeds=t.breeds,!0})},d.loadSubCategories=function(e){if(!e)return void(d.subCategories=[]);angular.element.each(d.categoryData,function(t,a){a.id==e&&(d.subCategories=a.types,d.states=a.states,d.isAnimal="pets"===a.name.toLowerCase())})},d.nextClick=function(){o()?d.page++:t.citySourcedReporterForm.$setSubmitted()},d.prevClick=function(){o()&&d.page--}}e.controller("BaltCoGoReporterCtrl",["$http","$scope","NgMap","mapService",t])}(angular.module("baltcogoApp"));